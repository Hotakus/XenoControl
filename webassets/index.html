<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>XenoControl</title>
  <link rel="stylesheet" href="styles.css"/>
</head>

<body>
<div class="window">
  <div class="window-header" id="titlebar">
    <div class="header-left">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="white">
        <path d="M18 2h-3.5l-1-1h-5l-1 1H6v2h12V2zm3 7H3v11c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9zM8 12h2v5H8v-5zm6 0h2v5h-2v-5z"/>
      </svg>
      <span>XenoControl</span>
    </div>
    <div>
      <button id="minimize-button">🗕</button>
      <button id="close-button">✖</button>
    </div>
  </div>

  <div class="window-body">
    <div class="left-panel">
      <div class="card">
        <label for="device">🎮 选择设备:</label>
        <div class="device-select-row">
          <select id="device">
            <option value="null">请选择设备</option>
            <!--            <option value="0">Xbox 控制器 (COM3)</option>-->
            <!--            <option value="1">PS5 DualSense 控制器</option>-->
            <!--            <option value="2">Switch Pro 控制器</option>-->
          </select>
          <!-- 新的连接按钮 -->
          <button id="connect-button" title="连接设备" class="icon-button">
            <svg t="1753595424804" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19662" width="200" height="200">
              <path
                  d="M521.6 158.08a111.36 111.36 0 0 1 111.36 111.36V480l96 96V269.44a206.72 206.72 0 0 0-394.24-87.68L411.52 256a110.72 110.72 0 0 1 110.08-97.92zM864 846.08l-135.04-135.04-96-96-222.08-222.08-96-96-135.04-134.4L112 230.4l202.88 202.24v306.56a206.72 206.72 0 0 0 394.24 87.68l87.04 87.04z m-341.76 4.48a111.36 111.36 0 0 1-111.36-111.36V528.64l221.44 221.44a110.72 110.72 0 0 1-110.72 100.48z"
                  fill="#ffffff" p-id="19663"></path>
            </svg>
          </button>
          <!-- 修改后的扫描按钮（图标化） -->
          <button id="scan-button" title="扫描设备" class="icon-button">
            <svg t="1753598068869" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="23500" width="200" height="200">
              <path
                  d="M511.94 125.24c-118 0-227 54.22-298.6 142.52V85.33H128V469.34h341.33V384H240.67c48.43-104.78 154.16-173.43 271.27-173.43 164.72 0 298.73 134.01 298.73 298.73S676.66 808.03 511.94 808.03c-111.71 0-213.25-61.57-265-160.69l-75.64 39.5c66.51 127.39 197.04 206.52 340.64 206.52C723.71 893.37 896 721.08 896 509.3S723.71 125.24 511.94 125.24z"
                  fill="#ffffff" p-id="23501"></path>
            </svg>
          </button>
        </div>
        <div id="status-message" class="status-message">选择设备后点击连接按钮</div>
      </div>

      <div class="card controller-image"></div>
    </div>

    <div class="right-panel">
      <div class="card preset-card">
        <label for="preset">📂 预设方案:</label>
        <div class="preset-header">
          <select id="preset" class="preset-select">
            <option>默认</option>
          </select>
          <div class="preset-controls">
            <button id="save-preset" title="保存方案" class="icon-button">
              <svg t="1753597230725" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="20689" width="200" height="200">
                <path
                    d="M72.902194 16.295914h800.074322a23.563011 23.563011 0 0 1 18.773333 8.874667l117.561807 142.974623c3.721634 4.525419 5.527398 9.568344 5.527398 15.437076v764.080172c0 40.145204-32.745978 72.902194-72.902194 72.902193H72.913204C32.745978 1020.564645 0 987.807656 0 947.662452V89.198108C0 49.041892 32.745978 16.295914 72.902194 16.295914z m37.854967 516.217118a4.866753 4.866753 0 0 0-4.855742 4.877764v363.795269c0 2.664602 2.180129 4.844731 4.855742 4.844731h795.449807a4.844731 4.844731 0 0 0 4.855742-4.844731v-363.795269a4.877763 4.877763 0 0 0-4.855742-4.877764H110.757161zM228.616258 124.64172a4.877763 4.877763 0 0 0-4.855742 4.866753V354.105806c0 2.686624 2.180129 4.866753 4.855742 4.866753h557.606538a4.866753 4.866753 0 0 0 4.855742-4.866753V129.508473a4.877763 4.877763 0 0 0-4.855742-4.866753H228.616258z"
                    fill="#ffffff" p-id="20690"></path>
              </svg>
            </button>
            <button id="import-preset" title="导入方案" class="icon-button">
              <svg t="1753597486869" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="22279" width="64" height="64">
                <path
                    d="M601.152 708.288 400 568 344 568l0 112-224 0 0 112 224 0 0 112L400 904l201.152-140.288C624 749.504 624 722.496 601.152 708.288L601.152 708.288zM891.264 331.2 638.656 76.864C630.528 68.608 619.456 64 607.936 64L232 64C196.032 64 176 83.712 176 120L176 512 288 512 288 176l280 0 0 168c0 24.192 32 56 56 56l168 0 0.768 448L624 848 624 960l224 0c35.968 0 56-19.712 56-56L904 362.176C904 350.528 899.392 339.392 891.264 331.2L891.264 331.2z"
                    p-id="22280" fill="#ffffff"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="tabs" role="tablist">
          <div class="tab active" role="tab" aria-selected="true" data-tab="buttonMapTab">按键映射</div>
          <div class="tab" role="tab" aria-selected="false" data-tab="stickMapTab">摇杆映射</div>
          <div class="tab" role="tab" aria-selected="false" data-tab="settingTab">设置</div>
        </div>

        <div id="buttonMapTab" class="tab-content active" role="tabpanel">
          <div class="tab-content-container">
            <div class="button-map-header">
              <div class="button-map-title"><i class="fas fa-keyboard"></i> 按键映射</div>
              <div class="button-map-controls">
                <button id="add-button-map" title="添加映射" class="icon-button">
                  <svg t="1753626247148" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2595" width="200" height="200">
                    <path d="M508.9 926.4c-36.3-1.6-64.6-32.2-64.6-68.6V166.1c0-36.3 28.3-66.9 64.6-68.6 38.8-1.7 70.7 29.2 70.7 67.6v693.7c0 38.4-31.9 69.4-70.7 67.6z" fill="#ffffff" p-id="2596"></path>
                    <path d="M858.9 579.6H165.2c-37.4 0-67.6-30.3-67.6-67.6 0-37.4 30.3-67.6 67.6-67.6h693.7c37.4 0 67.6 30.3 67.6 67.6 0 37.4-30.3 67.6-67.6 67.6z" fill="#ffffff" p-id="2597"></path>
                  </svg>
                </button>
              </div>
            </div>
            <div class="button-map" id="button-mapping-list">
              <div class="empty-state">
                <p>尚未添加任何按键映射
                  点击右上角的按钮添加映射
                </p>
              </div>
            </div>
          </div>
        </div>

        <div id="stickMapTab" class="tab-content" role="tabpanel">
          <div class="tab-content-container">
            <div class="stick-map">
              <div class="button-map-item">
                <div class="button-icon"><i class="fas fa-arrows-alt"></i></div>
                <div class="key-text">左摇杆</div>
                <div class="key-value">WASD 方向键</div>
                <div class="item-actions">
                  <button class="item-action-btn edit"><i class="fas fa-edit"></i></button>
                  <button class="item-action-btn delete"><i class="fas fa-trash-alt"></i></button>
                </div>
              </div>
              <div class="button-map-item">
                <div class="button-icon"><i class="fas fa-arrows-alt"></i></div>
                <div class="key-text">右摇杆</div>
                <div class="key-value">鼠标移动</div>
                <div class="item-actions">
                  <button class="item-action-btn edit"><i class="fas fa-edit"></i></button>
                  <button class="item-action-btn delete"><i class="fas fa-trash-alt"></i></button>
                </div>
              </div>
              <div class="button-map-item">
                <div class="button-icon"><i class="fas fa-th"></i></div>
                <div class="key-text">方向键</div>
                <div class="key-value">键盘方向键</div>
                <div class="item-actions">
                  <button class="item-action-btn edit"><i class="fas fa-edit"></i></button>
                  <button class="item-action-btn delete"><i class="fas fa-trash-alt"></i></button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="settingTab" class="tab-content" role="tabpanel">
          <div class="settings-container">
            <!-- 摇杆设置组 -->
            <div class="setting-group">
              <h3><i class="fas fa-gamepad"></i> 摇杆设置</h3>

              <div class="setting-item">
                <label for="deadzone">死区范围:</label>
                <div class="slider-container">
                  <input type="range" id="deadzone" min="0" max="30" value="10">
                  <span id="deadzone-value">10%</span>
                </div>
              </div>
            </div>

            <!-- 软件设置组 -->
            <div class="setting-group">
              <h3><i class="fas fa-cog"></i> 软件设置</h3>

              <div class="setting-item">
                <label for="auto-start">开机自启动:</label>
                <label class="switch">
                  <input type="checkbox" id="auto-start" checked>
                  <span class="slider round"></span>
                </label>
              </div>

              <div class="setting-item">
                <label for="minimize-to-tray">最小化到托盘:</label>
                <label class="switch">
                  <input type="checkbox" id="minimize-to-tray" checked>
                  <span class="slider round"></span>
                </label>
              </div>

              <!-- 新增轮询频率设置项 -->
              <div class="setting-item">
                <label for="polling-frequency">轮询频率:</label>
                <div class="polling-container">
                  <input type="number" id="polling-frequency" min="1" max="8000" value="125">
                  <span>Hz</span>
                </div>
              </div>

              <div class="setting-item">
                <label for="theme">界面主题:</label>
                <select id="theme">
                  <option value="light">浅色模式</option>
                  <option value="dark">深色模式</option>
                  <option value="system">跟随系统</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="window-footer">
    <div class="indicator-container">
      <span class="indicator-label">连接状态</span>
      <div id="status-indicator" class="indicator"></div>
    </div>

    <div>
      <span>© 2025 XenoControl</span>
      <a id="github-link" href="https://github.com/Hotakus/XenoControl" target="_blank" rel="noopener noreferrer" title="GitHub 仓库">GitHub</a>
    </div>
  </div>
</div>

<!-- 添加映射模态窗口 -->
<div class="modal-overlay" id="mapping-modal">
  <div class="modal">
    <div class="modal-header">
      <span id="modal-title">添加按键映射</span>
      <button class="modal-close" id="close-modal">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label><i class="fas fa-gamepad"></i> 选择手柄按键</label>
        <select class="form-control" id="controller-button">
          <option value="">-- 请选择按键 --</option>
          <option value="A">A 按钮</option>
          <option value="B">B 按钮</option>
          <option value="X">X 按钮</option>
          <option value="Y">Y 按钮</option>
          <option value="LB">左肩键 (LB)</option>
          <option value="RB">右肩键 (RB)</option>
        </select>
      </div>

      <div class="form-group key-detector">
        <label><i class="fas fa-keyboard"></i> 映射到键盘按键</label>
        <div class="detector-area" id="key-detector-area">
          点击此处并按下键盘按键或组合键
        </div>
        <div class="detector-hint">支持单键或组合键（如 Ctrl+C、Alt+F4）</div>
        <div class="key-display" id="key-display"></div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" id="cancel-btn">取消</button>
      <button class="btn btn-primary" id="confirm-btn">确认</button>
    </div>
  </div>
</div>

<script src="main.js"></script>
</body>
</html>